{"ast":null,"code":"import _asyncToGenerator from \"/Users/ivangarciaparras/Git/ivan-garcia-parras/homebridge-eufy-legacy/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { DEFAULT_CAMERACONFIG_VALUES, DEFAULT_CONFIG_VALUES } from '../../../app/util/default-config-values';\nimport { ConfigOptionsInterpreter } from '../config-options-interpreter';\nimport { faPlusCircle, faMinusCircle, faCircle } from '@fortawesome/free-solid-svg-icons';\nimport { ChargingStatus } from '../../util/eufy-security-client.utils';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../app/plugin.service\";\nimport * as i2 from \"../../accessory.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"@fortawesome/angular-fontawesome\";\n\nfunction SnapshotHandlingMethodComponent_div_12_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1, \" You can enable this setting nevertheless in \");\n    i0.ɵɵelementStart(2, \"a\", 10);\n    i0.ɵɵtext(3, \"Plugin Settings\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(4, \"p\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SnapshotHandlingMethodComponent_div_12_li_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const sn_r9 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(sn_r9);\n  }\n}\n\nfunction SnapshotHandlingMethodComponent_div_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1, \" There are other cameras connected through the same station as this device. One station can only ever stream from one camera at the same time. Therefore it is not recommened to use another snapshot method other than cloud snapshots.\");\n    i0.ɵɵelement(2, \"p\");\n    i0.ɵɵtemplate(3, SnapshotHandlingMethodComponent_div_12_div_3_Template, 5, 0, \"div\", 7);\n    i0.ɵɵtext(4, \" Cameras on the same station: \");\n    i0.ɵɵelementStart(5, \"ul\");\n    i0.ɵɵtemplate(6, SnapshotHandlingMethodComponent_div_12_li_6_Template, 2, 1, \"li\", 9);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.ignoreMultipleDevicesWarning);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.camerasOnSameStation);\n  }\n}\n\nfunction SnapshotHandlingMethodComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8)(1, \"b\");\n    i0.ɵɵtext(2, \"Caution!\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3, \" While Force Refresh Snapshots will deliver most up-to-date snapshots, this can have negative effects on HomeKit behaviour. For example starting a livestream might be delayed as a side effect by this option. See \");\n    i0.ɵɵelementStart(4, \"a\", 11);\n    i0.ɵɵtext(5, \"here\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(6, \" for more informtaion. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SnapshotHandlingMethodComponent_div_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵtext(1, \" Since your device is battery powered and currently not charging we don't recommend using this setting. The battery life will most likely decrease significantly. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SnapshotHandlingMethodComponent_div_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12);\n    i0.ɵɵtext(1, \" Please be advised that since your device is only solar powered we cannot guarantee optimal results with this setting. It might well be, that your battery is depleting faster than it can be recharged by the sun. This depends heavily on your exact use case. \");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SnapshotHandlingMethodComponent_small_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\")(1, \"i\")(2, \"b\");\n    i0.ɵɵtext(3, \"Description:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \" The plugin will try to get the latest possible snapshot. If none is present the plugin will start a livestream to render one frame.\");\n    i0.ɵɵelement(5, \"br\");\n    i0.ɵɵtext(6, \" This process might take a few seconds and can slow down your homebridge instance for this duration. If you encounter problems with this method please try another. \");\n    i0.ɵɵelement(7, \"p\")(8, \"fa-icon\", 13);\n    i0.ɵɵtext(9, \" Up-to-date Snapshots (events)\");\n    i0.ɵɵelement(10, \"br\")(11, \"fa-icon\", 13);\n    i0.ɵɵtext(12, \" Up-to-date Snapshots (HomeKit View)\");\n    i0.ɵɵelement(13, \"br\")(14, \"fa-icon\", 14);\n    i0.ɵɵtext(15, \" Performance\");\n    i0.ɵɵelement(16, \"br\")(17, \"fa-icon\", 14);\n    i0.ɵɵtext(18, \" Battery life\");\n    i0.ɵɵelement(19, \"br\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"icon\", ctx_r4.plusIcon);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"icon\", ctx_r4.plusIcon);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"icon\", ctx_r4.minusIcon);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"icon\", ctx_r4.minusIcon);\n  }\n}\n\nfunction SnapshotHandlingMethodComponent_small_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\")(1, \"i\")(2, \"b\");\n    i0.ɵɵtext(3, \"Description:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \" This mode combines the other two. When a snapshot is requested the plugin will try to get a new snapshot from the camera.\");\n    i0.ɵɵelement(5, \"br\");\n    i0.ɵɵtext(6, \" After one second the snapshot will be delivered - if necessary by using an older snapshot. For events the plugin will wait on a new snapshot. \");\n    i0.ɵɵelement(7, \"p\")(8, \"fa-icon\", 13);\n    i0.ɵɵtext(9, \" Up-to-date Snapshots (events)\");\n    i0.ɵɵelement(10, \"br\")(11, \"fa-icon\", 15);\n    i0.ɵɵtext(12, \" Up-to-date Snapshots (HomeKit View)\");\n    i0.ɵɵelement(13, \"br\")(14, \"fa-icon\", 13);\n    i0.ɵɵtext(15, \" Performance\");\n    i0.ɵɵelement(16, \"br\")(17, \"fa-icon\", 14);\n    i0.ɵɵtext(18, \" Battery life\");\n    i0.ɵɵelement(19, \"br\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"icon\", ctx_r5.plusIcon);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"icon\", ctx_r5.mediumIcon);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"icon\", ctx_r5.plusIcon);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"icon\", ctx_r5.minusIcon);\n  }\n}\n\nfunction SnapshotHandlingMethodComponent_small_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\")(1, \"i\")(2, \"b\");\n    i0.ɵɵtext(3, \"Description:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \" The plugin will preferablly use cloud snapshots from eufy to fulfill snapshot requests as fast as possible.\");\n    i0.ɵɵelement(5, \"br\");\n    i0.ɵɵtext(6, \" If an event, like motion or doorbell ring oocurs, the plugin will try to wait for a cloud snapshot to be provided. But the periodic snapshots in homekit will most likely be outdated (e.g. up to a few hours old). \");\n    i0.ɵɵelement(7, \"p\")(8, \"fa-icon\", 13);\n    i0.ɵɵtext(9, \" Up-to-date Snapshots (events)\");\n    i0.ɵɵelement(10, \"br\")(11, \"fa-icon\", 14);\n    i0.ɵɵtext(12, \" Up-to-date Snapshots (HomeKit View)\");\n    i0.ɵɵelement(13, \"br\")(14, \"fa-icon\", 13);\n    i0.ɵɵtext(15, \" Performance\");\n    i0.ɵɵelement(16, \"br\")(17, \"fa-icon\", 13);\n    i0.ɵɵtext(18, \" Battery life\");\n    i0.ɵɵelement(19, \"br\");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(8);\n    i0.ɵɵproperty(\"icon\", ctx_r6.plusIcon);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"icon\", ctx_r6.minusIcon);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"icon\", ctx_r6.plusIcon);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"icon\", ctx_r6.plusIcon);\n  }\n}\n\nexport let SnapshotHandlingMethodComponent = /*#__PURE__*/(() => {\n  class SnapshotHandlingMethodComponent extends ConfigOptionsInterpreter {\n    constructor(pluginService, accessoryService) {\n      super(pluginService);\n      this.accessoryService = accessoryService;\n      /** Customize from here */\n\n      /** updateConfig() will overwrite any settings that you'll provide */\n\n      /** Don't try and 'append'/'push' to arrays this way - add a custom method instead */\n\n      /** see config option to ignore devices as example */\n\n      /** updateConfig() takes an optional second parameter to specify the accessoriy for which the setting is changed */\n\n      this.plusIcon = faPlusCircle;\n      this.minusIcon = faMinusCircle;\n      this.mediumIcon = faCircle;\n      this.value = DEFAULT_CAMERACONFIG_VALUES.snapshotHandlingMethod;\n      this.chargingStatus = ChargingStatus.PLUGGED;\n      this.camerasOnSameStation = [];\n      this.ignoreMultipleDevicesWarning = DEFAULT_CONFIG_VALUES.ignoreMultipleDevicesWarning;\n    }\n\n    ngOnInit() {\n      this.readValue();\n    }\n\n    readValue() {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        var _a;\n\n        const config = yield _this.getCameraConfig(((_a = _this.accessory) === null || _a === void 0 ? void 0 : _a.uniqueId) || '');\n\n        if (config && Object.prototype.hasOwnProperty.call(config, 'snapshotHandlingMethod')) {\n          _this.value = config['snapshotHandlingMethod'];\n        } else if (config && Object.prototype.hasOwnProperty.call(config, 'forcerefreshsnap')) {\n          _this.value = config['forcerefreshsnap'] ? 1 : 3;\n        }\n\n        if (_this.accessory) {\n          _this.accessoryService.getChargingStatus(_this.accessory.uniqueId).then(chargingStatus => _this.chargingStatus = chargingStatus);\n\n          if (Object.prototype.hasOwnProperty.call(_this.config, 'ignoreMultipleDevicesWarning')) {\n            _this.ignoreMultipleDevicesWarning = _this.config['ignoreMultipleDevicesWarning'];\n          }\n\n          const ignoredDevices = config && Object.prototype.hasOwnProperty.call(config, 'ignoreDevices') ? config['ignoreDevices'] : [];\n\n          _this.accessoryService.getCamerasOnSameStation(_this.accessory.uniqueId, ignoredDevices).then(devices => {\n            _this.camerasOnSameStation = devices;\n\n            if (_this.camerasOnSameStation.length > 1 && !_this.ignoreMultipleDevicesWarning) {\n              _this.value = 3;\n\n              _this.update();\n            }\n          });\n        }\n      })();\n    }\n\n    update() {\n      this.updateConfig({\n        snapshotHandlingMethod: this.value\n      }, this.accessory);\n    }\n\n  }\n\n  SnapshotHandlingMethodComponent.ɵfac = function SnapshotHandlingMethodComponent_Factory(t) {\n    return new (t || SnapshotHandlingMethodComponent)(i0.ɵɵdirectiveInject(i1.PluginService), i0.ɵɵdirectiveInject(i2.AccessoryService));\n  };\n\n  SnapshotHandlingMethodComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SnapshotHandlingMethodComponent,\n    selectors: [[\"app-snapshot-handling-method\"]],\n    inputs: {\n      accessory: \"accessory\"\n    },\n    features: [i0.ɵɵInheritDefinitionFeature],\n    decls: 19,\n    vars: 12,\n    consts: [[1, \"settingsItem\", \"row\", \"p-3\"], [1, \"d-flex\", \"flex-column\", \"flex-sm-row\", \"justify-content-between\", \"align-items-start\", \"align-items-sm-center\", \"mb-2\"], [1, \"col-12\", \"col-sm-4\"], [\"aria-label\", \"Device Operation Mode\", 1, \"form-select\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [3, \"ngValue\"], [\"class\", \"alert alert-warning\", \"role\", \"alert\", 4, \"ngIf\"], [\"class\", \"alert alert-secondary\", \"role\", \"alert\", 4, \"ngIf\"], [4, \"ngIf\"], [\"role\", \"alert\", 1, \"alert\", \"alert-warning\"], [4, \"ngFor\", \"ngForOf\"], [\"routerLink\", \"/advancedConfig\"], [\"href\", \"https://github.com/homebridge-eufy-security/plugin/wiki/Streaming-Settings#streams-take-a-long-time-to-start\", \"target\", \"_blank\", \"rel\", \"noopener noreferrer\"], [\"role\", \"alert\", 1, \"alert\", \"alert-secondary\"], [\"size\", \"xs\", 1, \"m-1\", 2, \"color\", \"#7FFF00\", 3, \"icon\"], [\"size\", \"xs\", 1, \"m-1\", 2, \"color\", \"#B22222\", 3, \"icon\"], [\"size\", \"xs\", 1, \"m-1\", 2, \"color\", \"#FF8C00\", 3, \"icon\"]],\n    template: function SnapshotHandlingMethodComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"span\");\n        i0.ɵɵtext(3, \"Snapshot Handling Method\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"div\", 2)(5, \"select\", 3);\n        i0.ɵɵlistener(\"ngModelChange\", function SnapshotHandlingMethodComponent_Template_select_ngModelChange_5_listener($event) {\n          return ctx.value = $event;\n        })(\"change\", function SnapshotHandlingMethodComponent_Template_select_change_5_listener() {\n          return ctx.update();\n        });\n        i0.ɵɵelementStart(6, \"option\", 4);\n        i0.ɵɵtext(7, \"Force Refresh Snapshots\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"option\", 4);\n        i0.ɵɵtext(9, \"Balanced\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"option\", 4);\n        i0.ɵɵtext(11, \"Cloud Snapshots\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵtemplate(12, SnapshotHandlingMethodComponent_div_12_Template, 7, 2, \"div\", 5);\n        i0.ɵɵtemplate(13, SnapshotHandlingMethodComponent_div_13_Template, 7, 0, \"div\", 5);\n        i0.ɵɵtemplate(14, SnapshotHandlingMethodComponent_div_14_Template, 2, 0, \"div\", 5);\n        i0.ɵɵtemplate(15, SnapshotHandlingMethodComponent_div_15_Template, 2, 0, \"div\", 6);\n        i0.ɵɵtemplate(16, SnapshotHandlingMethodComponent_small_16_Template, 20, 4, \"small\", 7);\n        i0.ɵɵtemplate(17, SnapshotHandlingMethodComponent_small_17_Template, 20, 4, \"small\", 7);\n        i0.ɵɵtemplate(18, SnapshotHandlingMethodComponent_small_18_Template, 20, 4, \"small\", 7);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.value);\n        i0.ɵɵattribute(\"disabled\", ctx.camerasOnSameStation.length > 1 && !ctx.ignoreMultipleDevicesWarning ? true : null);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngValue\", 1);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngValue\", 2);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngValue\", 3);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.camerasOnSameStation.length > 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.value === 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.chargingStatus === 2 && ctx.value === 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.chargingStatus === 4 && ctx.value === 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.value === 1);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.value === 2);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.value === 3);\n      }\n    },\n    directives: [i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i4.NgIf, i5.RouterLinkWithHref, i4.NgForOf, i6.FaIconComponent],\n    encapsulation: 2\n  });\n  return SnapshotHandlingMethodComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}